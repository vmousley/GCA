---
title: "Data Import"
author: "Teresa Del Bianco"
date: "`r Sys.Date()`"
output: html_document
---

# Load packages 

```{r, message = FALSE, warning = FALSE, include = FALSE}
packs <- c("R.matlab", "reshape2", "dplyr", "multidplyr", "tidyr")
lapply(packs, require, character.only = TRUE)
```

# Read data from matlab (? Hz)

```{r}
cbfnp_matlabFile  <- readMat('Data/MatFiles/LEAP_ET_popout_temporalScores_20191017T165644.mat')
```

AOIS: face, car, phone, noise, bird

There are 8 trials of 10 sec duration. Each trial is identified by the item id (e.g, STATICIMAGES_ONSETPOPOUT1.TIFPOPOUT)

# Trial 1

## AOI = Car

```{r}
datList <- cbfnp_matlabFile$temporal[[1]][[1]][,,2]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
ids <- datList.un$ids
time <- datList.un$time
summary(datList.un)
str(datList.un)
```
```{r}
data_c <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_c) <- ids
```
```{r}
data_c$time <- time
```
```{r}
data_c$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_c[,c(1,ncol(data_c)-1,ncol(data_c))])
```

### Format data

```{r}
names(data)
data_c_long <- melt(data_c,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="car.plt"
        )
# str(data_c_long)
```
```{r}
id_tp <- colsplit(as.character(data_c_long$id), "_", c("id", "tp"))
data_c_long <- cbind(id_tp, dplyr::select(data_c_long, -id))
```

```{r}
# head(data_c_long)
```

## AOI = Bird

```{r}
datList <- cbfnp_matlabFile$temporal[[1]][[1]][,,5]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
ids <- datList.un$ids
time <- datList.un$time
summary(datList.un)
str(datList.un)
```
```{r}
data_b <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_b) <- ids
```
```{r}
data_b$time <- time
```
```{r}
data_b$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_b[,c(1,ncol(data_b)-1,ncol(data_b))])
```

### Format data

```{r}
names(data)
data_b_long <- melt(data_b,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="bird.plt"
        )
str(data_b_long)
```
```{r}
id_tp <- colsplit(as.character(data_b_long$id), "_", c("id", "tp"))
data_b_long <- cbind(id_tp, dplyr::select(data_b_long, -id))
```

## AOI = Face

```{r}
datList <- cbfnp_matlabFile$temporalScores[[1]][[1]][,,1]
# summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
# summary(datList.un)
# str(datList.un)
```
```{r}
data_f <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_f) <- datList.un[[3]]
```
```{r}
data_f$time <- datList.un[[4]][,1]
```
```{r}
data_f$aoi.name <- datList.un[[1]][,1]
```

### Format data

```{r}
# names(data)
data_f_long <- melt(data_f,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="face.plt"
        )
# str(data_f_long)
```
```{r}
id_tp <- colsplit(as.character(data_f_long$id), "_", c("id", "tp"))
data_f_long <- cbind(id_tp, dplyr::select(data_f_long, -id))
```

## AOI = Noise

```{r}
datList <- cbfnp_matlabFile$temporalScores[[1]][[1]][,,4]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_n <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_n) <- datList.un[[3]]
```
```{r}
data_n$time <- datList.un[[4]][,1]
```
```{r}
data_n$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_n[,c(1,ncol(data_n)-1,ncol(data_n))])
```

### Format data

```{r}
names(data)
data_n_long <- melt(data_n,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="noise.plt"
        )
# str(data_n_long)
```
```{r}
id_tp <- colsplit(as.character(data_n_long$id), "_", c("id", "tp"))
data_n_long <- cbind(id_tp, dplyr::select(data_n_long, -id))
```

## AOI = Phone

```{r}
datList <- cbfnp_matlabFile$temporalScores[[1]][[1]][,,3]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_p <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_p) <- datList.un[[3]]
```
```{r}
data_p$time <- datList.un[[4]][,1]
```
```{r}
data_p$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_p[,c(1,ncol(data_p)-1,ncol(data_p))])
```

### Format data

```{r}
# names(data)
data_p_long <- melt(data_p,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="phone.plt"
        )
# str(data_p_long)
```
```{r}
id_tp <- colsplit(as.character(data_p_long$id), "_", c("id", "tp"))
data_p_long <- cbind(id_tp, dplyr::select(data_p_long, -id))
```

## Merge datasets

```{r}
# dim(data_c_long)
# dim(data_b_long)
```

```{r}
# cbfnp <- rbind(data_c_long, data_b_long, data_f_long, data_n_long, data_p_long)
cbfnp <- data_c_long %>%
  left_join(data_b_long, by=c("id", "tp", "time")) %>%
  left_join(data_f_long, by=c("id", "tp", "time")) %>%
  left_join(data_n_long, by=c("id", "tp", "time")) %>%
  left_join(data_p_long, by=c("id", "tp", "time"))
cbfnp.1 <- cbfnp %>%
  mutate(stim="STATICIMAGES_ONSETPOPOUT1.TIF",
         trial=1) 
# head(cbfnp.1)
```

```{r}
rm(list=setdiff(ls(), ls(pattern = c("cbfnp"))))
```

# Trial 2

## AOI = Car

```{r}
datList <- cbfnp_matlabFile$temporalScores[[2]][[1]][,,2]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_c <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_c) <- datList.un[[3]]
```
```{r}
data_c$time <- datList.un[[4]][,1]
```
```{r}
data_c$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_c[,c(1,ncol(data_c)-1,ncol(data_c))])
```

### Format data

```{r}
names(data)
data_c_long <- melt(data_c,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="car.plt"
        )
# str(data_c_long)
```
```{r}
id_tp <- colsplit(as.character(data_c_long$id), "_", c("id", "tp"))
data_c_long <- cbind(id_tp, select(data_c_long, -id))
```

## AOI = Bird

```{r}
datList <- cbfnp_matlabFile$temporalScores[[2]][[1]][,,5]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_b <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_b) <- datList.un[[3]]
```
```{r}
data_b$time <- datList.un[[4]][,1]
```
```{r}
data_b$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_b[,c(1,ncol(data_b)-1,ncol(data_b))])
```

### Format data

```{r}
names(data)
data_b_long <- melt(data_b,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="bird.plt"
        )
# str(data_b_long)
```
```{r}
id_tp <- colsplit(as.character(data_b_long$id), "_", c("id", "tp"))
data_b_long <- cbind(id_tp, select(data_b_long, -id))
```

## AOI = Face

```{r}
datList <- cbfnp_matlabFile$temporalScores[[2]][[1]][,,1]
# summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
# summary(datList.un)
# str(datList.un)
```
```{r}
data_f <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_f) <- datList.un[[3]]
```
```{r}
data_f$time <- datList.un[[4]][,1]
```
```{r}
data_f$aoi.name <- datList.un[[1]][,1]
```
```{r}
# head(data_f[,c(1,ncol(data_f)-1,ncol(data_f))])
```

### Format data

```{r}
# names(data)
data_f_long <- melt(data_f,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="face.plt"
        )
# str(data_f_long)
```
```{r}
#data_f_long <- select(data_f_long, -aoi.name)
id_tp <- colsplit(as.character(data_f_long$id), "_", c("id", "tp"))
data_f_long <- cbind(id_tp, dplyr::select(data_f_long, -id))
```

## AOI = Noise

```{r}
datList <- cbfnp_matlabFile$temporalScores[[2]][[1]][,,4]
# summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_n <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_n) <- datList.un[[3]]
```
```{r}
data_n$time <- datList.un[[4]][,1]
```
```{r}
data_n$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_n[,c(1,ncol(data_n)-1,ncol(data_n))])
```

### Format data

```{r}
# names(data)
data_n_long <- melt(data_n,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="noise.plt"
        )
# str(data_n_long)
```
```{r}

id_tp <- colsplit(as.character(data_n_long$id), "_", c("id", "tp"))
data_n_long <- cbind(id_tp, select(data_n_long, -id))
```

## AOI = Phone

```{r}
datList <- cbfnp_matlabFile$temporalScores[[2]][[1]][,,3]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_p <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_p) <- datList.un[[3]]
```
```{r}
data_p$time <- datList.un[[4]][,1]
```
```{r}
data_p$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_p[,c(1,ncol(data_p)-1,ncol(data_p))])
```

### Format data

```{r}
names(data)
data_p_long <- melt(data_p,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="phone.plt"
        )
str(data_p_long)
```
```{r}

id_tp <- colsplit(as.character(data_p_long$id), "_", c("id", "tp"))
data_p_long <- cbind(id_tp, select(data_p_long, -id))
```

## Merge datasets

```{r}
# dim(data_c_long)
# dim(data_b_long)
```

```{r}
# cbfnp <- rbind(data_c_long, data_b_long, data_f_long, data_n_long, data_p_long)
cbfnp <- data_c_long %>%
  left_join(data_b_long, by=c("id", "tp", "time")) %>%
  left_join(data_f_long, by=c("id", "tp", "time")) %>%
  left_join(data_n_long, by=c("id", "tp", "time")) %>%
  left_join(data_p_long, by=c("id", "tp", "time"))
cbfnp.2 <- cbfnp %>%
  mutate(stim="STATICIMAGES_ONSETPOPOUT2.TIF",
         trial=2) 
# head(cbfnp.1)
```

```{r}
rm(list=setdiff(ls(), ls(pattern = "cbfnp")))
```

# Trial 3

## AOI = Car

```{r}
datList <- cbfnp_matlabFile$temporalScores[[3]][[1]][,,2]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_c <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_c) <- datList.un[[3]]
```
```{r}
data_c$time <- datList.un[[4]][,1]
```
```{r}
data_c$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_c[,c(1,ncol(data_c)-1,ncol(data_c))])
```

### Format data

```{r}
# names(data)
data_c_long <- melt(data_c,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="car.plt"
        )
str(data_c_long)
```
```{r}

id_tp <- colsplit(as.character(data_c_long$id), "_", c("id", "tp"))
data_c_long <- cbind(id_tp, select(data_c_long, -id))
```

## AOI = Bird

```{r}
datList <- cbfnp_matlabFile$temporalScores[[3]][[1]][,,5]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_b <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_b) <- datList.un[[3]]
```
```{r}
data_b$time <- datList.un[[4]][,1]
```
```{r}
data_b$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_b[,c(1,ncol(data_b)-1,ncol(data_b))])
```

### Format data

```{r}
# names(data)
data_b_long <- melt(data_b,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="bird.plt"
        )
# str(data_b_long)
```
```{r}

id_tp <- colsplit(as.character(data_b_long$id), "_", c("id", "tp"))
data_b_long <- cbind(id_tp, select(data_b_long, -id))
```

## AOI = Face

```{r}
datList <- cbfnp_matlabFile$temporalScores[[3]][[1]][,,1]
# summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
# summary(datList.un)
# str(datList.un)
```
```{r}
data_f <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_f) <- datList.un[[3]]
```
```{r}
data_f$time <- datList.un[[4]][,1]
```
```{r}
data_f$aoi.name <- datList.un[[1]][,1]
```
```{r}
# head(data_f[,c(1,ncol(data_f)-1,ncol(data_f))])
```

### Format data

```{r}
# names(data)
data_f_long <- melt(data_f,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="face.plt"
        )
# str(data_f_long)
```
```{r}
#data_f_long <- select(data_f_long, -aoi.name)
id_tp <- colsplit(as.character(data_f_long$id), "_", c("id", "tp"))
data_f_long <- cbind(id_tp, dplyr::select(data_f_long, -id))
```

## AOI = Noise

```{r}
datList <- cbfnp_matlabFile$temporalScores[[3]][[1]][,,4]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_n <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_n) <- datList.un[[3]]
```
```{r}
data_n$time <- datList.un[[4]][,1]
```
```{r}
data_n$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_n[,c(1,ncol(data_n)-1,ncol(data_n))])
```

### Format data

```{r}
names(data)
data_n_long <- melt(data_n,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="noise.plt"
        )
# str(data_n_long)
```
```{r}

id_tp <- colsplit(as.character(data_n_long$id), "_", c("id", "tp"))
data_n_long <- cbind(id_tp, select(data_n_long, -id))
```

## AOI = Phone

```{r}
datList <- cbfnp_matlabFile$temporalScores[[3]][[1]][,,3]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_p <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_p) <- datList.un[[3]]
```
```{r}
data_p$time <- datList.un[[4]][,1]
```
```{r}
data_p$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_p[,c(1,ncol(data_p)-1,ncol(data_p))])
```

### Format data

```{r}
names(data)
data_p_long <- melt(data_p,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="phone.plt"
        )
str(data_p_long)
```
```{r}

id_tp <- colsplit(as.character(data_p_long$id), "_", c("id", "tp"))
data_p_long <- cbind(id_tp, select(data_p_long, -id))
```

## Merge datasets

```{r}
# dim(data_c_long)
# dim(data_b_long)
```

```{r}
# cbfnp <- rbind(data_c_long, data_b_long, data_f_long, data_n_long, data_p_long)
cbfnp <- data_c_long %>%
  left_join(data_b_long, by=c("id", "tp", "time")) %>%
  left_join(data_f_long, by=c("id", "tp", "time")) %>%
  left_join(data_n_long, by=c("id", "tp", "time")) %>%
  left_join(data_p_long, by=c("id", "tp", "time"))
cbfnp.3 <- cbfnp %>%
  mutate(stim="STATICIMAGES_ONSETPOPOUT3.TIF",
         trial=3) 
# head(cbfnp.3)
```

```{r}
rm(list=setdiff(ls(), ls(pattern = "cbfnp")))
```





# Trial 4

## AOI = Car

```{r}
datList <- cbfnp_matlabFile$temporalScores[[4]][[1]][,,2]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_c <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_c) <- datList.un[[3]]
```
```{r}
data_c$time <- datList.un[[4]][,1]
```
```{r}
data_c$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_c[,c(1,ncol(data_c)-1,ncol(data_c))])
```

### Format data

```{r}
names(data)
data_c_long <- melt(data_c,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="car.plt"
        )
str(data_c_long)
```
```{r}

id_tp <- colsplit(as.character(data_c_long$id), "_", c("id", "tp"))
data_c_long <- cbind(id_tp, select(data_c_long, -id))
```

## AOI = Bird

```{r}
datList <- cbfnp_matlabFile$temporalScores[[4]][[1]][,,5]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_b <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_b) <- datList.un[[3]]
```
```{r}
data_b$time <- datList.un[[4]][,1]
```
```{r}
data_b$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_b[,c(1,ncol(data_b)-1,ncol(data_b))])
```

### Format data

```{r}
names(data)
data_b_long <- melt(data_b,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="bird.plt"
        )
str(data_b_long)
```
```{r}

id_tp <- colsplit(as.character(data_b_long$id), "_", c("id", "tp"))
data_b_long <- cbind(id_tp, select(data_b_long, -id))
```

## AOI = Face

```{r}
datList <- cbfnp_matlabFile$temporalScores[[4]][[1]][,,1]
# summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
# summary(datList.un)
# str(datList.un)
```
```{r}
data_f <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_f) <- datList.un[[3]]
```
```{r}
data_f$time <- datList.un[[4]][,1]
```
```{r}
data_f$aoi.name <- datList.un[[1]][,1]
```
```{r}
# head(data_f[,c(1,ncol(data_f)-1,ncol(data_f))])
```

### Format data

```{r}
# names(data)
data_f_long <- melt(data_f,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="face.plt"
        )
# str(data_f_long)
```
```{r}
#data_f_long <- select(data_f_long, -aoi.name)
id_tp <- colsplit(as.character(data_f_long$id), "_", c("id", "tp"))
data_f_long <- cbind(id_tp, dplyr::select(data_f_long, -id))
```

## AOI = Noise

```{r}
datList <- cbfnp_matlabFile$temporalScores[[4]][[1]][,,4]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_n <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_n) <- datList.un[[3]]
```
```{r}
data_n$time <- datList.un[[4]][,1]
```
```{r}
data_n$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_n[,c(1,ncol(data_n)-1,ncol(data_n))])
```

### Format data

```{r}
names(data)
data_n_long <- melt(data_n,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="noise.plt"
        )
str(data_n_long)
```
```{r}

id_tp <- colsplit(as.character(data_n_long$id), "_", c("id", "tp"))
data_n_long <- cbind(id_tp, select(data_n_long, -id))
```

## AOI = Phone

```{r}
datList <- cbfnp_matlabFile$temporalScores[[4]][[1]][,,3]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_p <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_p) <- datList.un[[3]]
```
```{r}
data_p$time <- datList.un[[4]][,1]
```
```{r}
data_p$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_p[,c(1,ncol(data_p)-1,ncol(data_p))])
```

### Format data

```{r}
names(data)
data_p_long <- melt(data_p,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="phone.plt"
        )
str(data_p_long)
```
```{r}

id_tp <- colsplit(as.character(data_p_long$id), "_", c("id", "tp"))
data_p_long <- cbind(id_tp, select(data_p_long, -id))
```

## Merge datasets

```{r}
dim(data_c_long)
dim(data_b_long)
```

```{r}
# cbfnp <- rbind(data_c_long, data_b_long, data_f_long, data_n_long, data_p_long)
cbfnp <- data_c_long %>%
  left_join(data_b_long, by=c("id", "tp", "time")) %>%
  left_join(data_f_long, by=c("id", "tp", "time")) %>%
  left_join(data_n_long, by=c("id", "tp", "time")) %>%
  left_join(data_p_long, by=c("id", "tp", "time"))
cbfnp.4 <- cbfnp %>%
  mutate(stim="STATICIMAGES_ONSETPOPOUT4.TIF",
         trial=4) 
# head(cbfnp.4)
```

```{r}
rm(list=setdiff(ls(), ls(pattern = "cbfnp")))
```

# Trial 5

## AOI = Car

```{r}
datList <- cbfnp_matlabFile$temporalScores[[5]][[1]][,,2]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_c <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_c) <- datList.un[[3]]
```
```{r}
data_c$time <- datList.un[[4]][,1]
```
```{r}
data_c$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_c[,c(1,ncol(data_c)-1,ncol(data_c))])
```

### Format data

```{r}
names(data)
data_c_long <- melt(data_c,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="car.plt"
        )
str(data_c_long)
```
```{r}

id_tp <- colsplit(as.character(data_c_long$id), "_", c("id", "tp"))
data_c_long <- cbind(id_tp, select(data_c_long, -id))
```

## AOI = Bird

```{r}
datList <- cbfnp_matlabFile$temporalScores[[5]][[1]][,,5]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_b <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_b) <- datList.un[[3]]
```
```{r}
data_b$time <- datList.un[[4]][,1]
```
```{r}
data_b$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_b[,c(1,ncol(data_b)-1,ncol(data_b))])
```

### Format data

```{r}
names(data)
data_b_long <- melt(data_b,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="bird.plt"
        )
str(data_b_long)
```
```{r}

id_tp <- colsplit(as.character(data_b_long$id), "_", c("id", "tp"))
data_b_long <- cbind(id_tp, select(data_b_long, -id))
```

## AOI = Face

```{r}
datList <- cbfnp_matlabFile$temporalScores[[5]][[1]][,,1]
# summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
# summary(datList.un)
# str(datList.un)
```
```{r}
data_f <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_f) <- datList.un[[3]]
```
```{r}
data_f$time <- datList.un[[4]][,1]
```
```{r}
data_f$aoi.name <- datList.un[[1]][,1]
```
```{r}
# head(data_f[,c(1,ncol(data_f)-1,ncol(data_f))])
```

### Format data

```{r}
# names(data)
data_f_long <- melt(data_f,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="face.plt"
        )
# str(data_f_long)
```
```{r}
#data_f_long <- select(data_f_long, -aoi.name)
id_tp <- colsplit(as.character(data_f_long$id), "_", c("id", "tp"))
data_f_long <- cbind(id_tp, dplyr::select(data_f_long, -id))
```

## AOI = Noise

```{r}
datList <- cbfnp_matlabFile$temporalScores[[5]][[1]][,,4]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_n <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_n) <- datList.un[[3]]
```
```{r}
data_n$time <- datList.un[[4]][,1]
```
```{r}
data_n$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_n[,c(1,ncol(data_n)-1,ncol(data_n))])
```

### Format data

```{r}
names(data)
data_n_long <- melt(data_n,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="noise.plt"
        )
str(data_n_long)
```
```{r}

id_tp <- colsplit(as.character(data_n_long$id), "_", c("id", "tp"))
data_n_long <- cbind(id_tp, select(data_n_long, -id))
```

## AOI = Phone

```{r}
datList <- cbfnp_matlabFile$temporalScores[[5]][[1]][,,3]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_p <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_p) <- datList.un[[3]]
```
```{r}
data_p$time <- datList.un[[4]][,1]
```
```{r}
data_p$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_p[,c(1,ncol(data_p)-1,ncol(data_p))])
```

### Format data

```{r}
names(data)
data_p_long <- melt(data_p,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="phone.plt"
        )
str(data_p_long)
```
```{r}

id_tp <- colsplit(as.character(data_p_long$id), "_", c("id", "tp"))
data_p_long <- cbind(id_tp, select(data_p_long, -id))
```

## Merge datasets

```{r}
# dim(data_c_long)
# dim(data_b_long)
```

```{r}
# cbfnp <- rbind(data_c_long, data_b_long, data_f_long, data_n_long, data_p_long)
cbfnp <- data_c_long %>%
  left_join(data_b_long, by=c("id", "tp", "time")) %>%
  left_join(data_f_long, by=c("id", "tp", "time")) %>%
  left_join(data_n_long, by=c("id", "tp", "time")) %>%
  left_join(data_p_long, by=c("id", "tp", "time"))
cbfnp.5 <- cbfnp %>%
  mutate(stim="STATICIMAGES_ONSETPOPOUT5.TIF",
         trial=5) 
# head(cbfnp.5)
```

```{r}
rm(list=setdiff(ls(), ls(pattern = "cbfnp")))
```

# Trial 6

## AOI = Car

```{r}
datList <- cbfnp_matlabFile$temporalScores[[6]][[1]][,,2]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_c <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_c) <- datList.un[[3]]
```
```{r}
data_c$time <- datList.un[[4]][,1]
```
```{r}
data_c$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_c[,c(1,ncol(data_c)-1,ncol(data_c))])
```

### Format data

```{r}
names(data)
data_c_long <- melt(data_c,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="car.plt"
        )
str(data_c_long)
```
```{r}

id_tp <- colsplit(as.character(data_c_long$id), "_", c("id", "tp"))
data_c_long <- cbind(id_tp, select(data_c_long, -id))
```

## AOI = Bird

```{r}
datList <- cbfnp_matlabFile$temporalScores[[6]][[1]][,,5]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_b <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_b) <- datList.un[[3]]
```
```{r}
data_b$time <- datList.un[[4]][,1]
```
```{r}
data_b$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_b[,c(1,ncol(data_b)-1,ncol(data_b))])
```

### Format data

```{r}
names(data)
data_b_long <- melt(data_b,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="bird.plt"
        )
str(data_b_long)
```
```{r}

id_tp <- colsplit(as.character(data_b_long$id), "_", c("id", "tp"))
data_b_long <- cbind(id_tp, select(data_b_long, -id))
```

## AOI = Face

```{r}
datList <- cbfnp_matlabFile$temporalScores[[6]][[1]][,,1]
# summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
# summary(datList.un)
# str(datList.un)
```
```{r}
data_f <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_f) <- datList.un[[3]]
```
```{r}
data_f$time <- datList.un[[4]][,1]
```
```{r}
data_f$aoi.name <- datList.un[[1]][,1]
```
```{r}
# head(data_f[,c(1,ncol(data_f)-1,ncol(data_f))])
```

### Format data

```{r}
# names(data)
data_f_long <- melt(data_f,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="face.plt"
        )
# str(data_f_long)
```
```{r}
#data_f_long <- select(data_f_long, -aoi.name)
id_tp <- colsplit(as.character(data_f_long$id), "_", c("id", "tp"))
data_f_long <- cbind(id_tp, dplyr::select(data_f_long, -id))
```

## AOI = Noise

```{r}
datList <- cbfnp_matlabFile$temporalScores[[6]][[1]][,,4]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_n <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_n) <- datList.un[[3]]
```
```{r}
data_n$time <- datList.un[[4]][,1]
```
```{r}
data_n$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_n[,c(1,ncol(data_n)-1,ncol(data_n))])
```

### Format data

```{r}
names(data)
data_n_long <- melt(data_n,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="noise.plt"
        )
str(data_n_long)
```
```{r}

id_tp <- colsplit(as.character(data_n_long$id), "_", c("id", "tp"))
data_n_long <- cbind(id_tp, select(data_n_long, -id))
```

## AOI = Phone

```{r}
datList <- cbfnp_matlabFile$temporalScores[[6]][[1]][,,3]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_p <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_p) <- datList.un[[3]]
```
```{r}
data_p$time <- datList.un[[4]][,1]
```
```{r}
data_p$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_p[,c(1,ncol(data_p)-1,ncol(data_p))])
```

### Format data

```{r}
names(data)
data_p_long <- melt(data_p,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="phone.plt"
        )
str(data_p_long)
```
```{r}

id_tp <- colsplit(as.character(data_p_long$id), "_", c("id", "tp"))
data_p_long <- cbind(id_tp, select(data_p_long, -id))
```

## Merge datasets

```{r}
# dim(data_c_long)
# dim(data_b_long)
```

```{r}
# cbfnp <- rbind(data_c_long, data_b_long, data_f_long, data_n_long, data_p_long)
cbfnp <- data_c_long %>%
  left_join(data_b_long, by=c("id", "tp", "time")) %>%
  left_join(data_f_long, by=c("id", "tp", "time")) %>%
  left_join(data_n_long, by=c("id", "tp", "time")) %>%
  left_join(data_p_long, by=c("id", "tp", "time"))
cbfnp.6 <- cbfnp %>%
  mutate(stim="STATICIMAGES_ONSETPOPOUT6.TIF",
         trial=6) 
# head(cbfnp.6)
```

```{r}
rm(list=setdiff(ls(), ls(pattern = "cbfnp")))
```

# Trial 7

## AOI = Car

```{r}
datList <- cbfnp_matlabFile$temporalScores[[7]][[1]][,,2]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_c <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_c) <- datList.un[[3]]
```
```{r}
data_c$time <- datList.un[[4]][,1]
```
```{r}
data_c$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_c[,c(1,ncol(data_c)-1,ncol(data_c))])
```

### Format data

```{r}
names(data)
data_c_long <- melt(data_c,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="car.plt"
        )
str(data_c_long)
```
```{r}

id_tp <- colsplit(as.character(data_c_long$id), "_", c("id", "tp"))
data_c_long <- cbind(id_tp, select(data_c_long, -id))
```

## AOI = Bird

```{r}
datList <- cbfnp_matlabFile$temporalScores[[7]][[1]][,,5]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_b <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_b) <- datList.un[[3]]
```
```{r}
data_b$time <- datList.un[[4]][,1]
```
```{r}
data_b$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_b[,c(1,ncol(data_b)-1,ncol(data_b))])
```

### Format data

```{r}
names(data)
data_b_long <- melt(data_b,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="bird.plt"
        )
str(data_b_long)
```
```{r}

id_tp <- colsplit(as.character(data_b_long$id), "_", c("id", "tp"))
data_b_long <- cbind(id_tp, select(data_b_long, -id))
```

## AOI = Face

```{r}
datList <- cbfnp_matlabFile$temporalScores[[7]][[1]][,,1]
# summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
# summary(datList.un)
# str(datList.un)
```
```{r}
data_f <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_f) <- datList.un[[3]]
```
```{r}
data_f$time <- datList.un[[4]][,1]
```
```{r}
data_f$aoi.name <- datList.un[[1]][,1]
```
```{r}
# head(data_f[,c(1,ncol(data_f)-1,ncol(data_f))])
```

### Format data

```{r}
names(data)
data_f_long <- melt(data_f,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="face.plt"
        )
str(data_f_long)
```
```{r}
# data_f_long <- select(data_f_long, -aoi.name)
id_tp <- colsplit(as.character(data_f_long$id), "_", c("id", "tp"))
data_f_long <- cbind(id_tp, dplyr::select(data_f_long, -id))
```

## AOI = Noise

```{r}
datList <- cbfnp_matlabFile$temporalScores[[7]][[1]][,,4]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
# summary(datList.un)
# str(datList.un)
```
```{r}
data_n <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_n) <- datList.un[[3]]
```
```{r}
data_n$time <- datList.un[[4]][,1]
```
```{r}
data_n$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_n[,c(1,ncol(data_n)-1,ncol(data_n))])
```

### Format data

```{r}
# names(data)
data_n_long <- melt(data_n,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="noise.plt"
        )
str(data_n_long)
```
```{r}

id_tp <- colsplit(as.character(data_n_long$id), "_", c("id", "tp"))
data_n_long <- cbind(id_tp, select(data_n_long, -id))
```

## AOI = Phone

```{r}
datList <- cbfnp_matlabFile$temporalScores[[7]][[1]][,,3]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_p <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_p) <- datList.un[[3]]
```
```{r}
data_p$time <- datList.un[[4]][,1]
```
```{r}
data_p$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_p[,c(1,ncol(data_p)-1,ncol(data_p))])
```

### Format data

```{r}
names(data)
data_p_long <- melt(data_p,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="phone.plt"
        )
# str(data_p_long)
```
```{r}
# 
id_tp <- colsplit(as.character(data_p_long$id), "_", c("id", "tp"))
data_p_long <- cbind(id_tp, select(data_p_long, -id))
```

## Merge datasets

```{r}
# dim(data_c_long)
# dim(data_b_long)
```

```{r}
# cbfnp <- rbind(data_c_long, data_b_long, data_f_long, data_n_long, data_p_long)
cbfnp <- data_c_long %>%
  left_join(data_b_long, by=c("id", "tp", "time")) %>%
  left_join(data_f_long, by=c("id", "tp", "time")) %>%
  left_join(data_n_long, by=c("id", "tp", "time")) %>%
  left_join(data_p_long, by=c("id", "tp", "time"))
cbfnp.7 <- cbfnp %>%
  mutate(stim="STATICIMAGES_ONSETPOPOUT7.TIF",
         trial=7) 
# head(cbfnp.7)
```

```{r}
rm(list=setdiff(ls(), ls(pattern = "cbfnp")))
```

# Trial 8

## AOI = Car

```{r}
datList <- cbfnp_matlabFile$temporalScores[[8]][[1]][,,2]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_c <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_c) <- datList.un[[3]]
```
```{r}
data_c$time <- datList.un[[4]][,1]
```
```{r}
data_c$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_c[,c(1,ncol(data_c)-1,ncol(data_c))])
```

### Format data

```{r}
names(data)
data_c_long <- melt(data_c,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="car.plt"
        )
str(data_c_long)
```
```{r}

id_tp <- colsplit(as.character(data_c_long$id), "_", c("id", "tp"))
data_c_long <- cbind(id_tp, select(data_c_long, -id))
```

## AOI = Bird

```{r}
datList <- cbfnp_matlabFile$temporalScores[[8]][[1]][,,5]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_b <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_b) <- datList.un[[3]]
```
```{r}
data_b$time <- datList.un[[4]][,1]
```
```{r}
data_b$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_b[,c(1,ncol(data_b)-1,ncol(data_b))])
```

### Format data

```{r}
names(data)
data_b_long <- melt(data_b,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="bird.plt"
        )
str(data_b_long)
```
```{r}

id_tp <- colsplit(as.character(data_b_long$id), "_", c("id", "tp"))
data_b_long <- cbind(id_tp, select(data_b_long, -id))
```

## AOI = Face

```{r}
datList <- cbfnp_matlabFile$temporalScores[[8]][[1]][,,1]
# summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
# summary(datList.un)
# str(datList.un)
```
```{r}
data_f <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_f) <- datList.un[[3]]
```
```{r}
data_f$time <- datList.un[[4]][,1]
```
```{r}
data_f$aoi.name <- datList.un[[1]][,1]
```
```{r}
# head(data_f[,c(1,ncol(data_f)-1,ncol(data_f))])
```

### Format data

```{r}
# names(data)
data_f_long <- melt(data_f,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="face.plt"
        )
# str(data_f_long)
```
```{r}
#data_f_long <- select(data_f_long, -aoi.name)
id_tp <- colsplit(as.character(data_f_long$id), "_", c("id", "tp"))
data_f_long <- cbind(id_tp, dplyr::select(data_f_long, -id))
```

## AOI = Noise

```{r}
datList <- cbfnp_matlabFile$temporalScores[[8]][[1]][,,4]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_n <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_n) <- datList.un[[3]]
```
```{r}
data_n$time <- datList.un[[4]][,1]
```
```{r}
data_n$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_n[,c(1,ncol(data_n)-1,ncol(data_n))])
```

### Format data

```{r}
names(data)
data_n_long <- melt(data_n,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="noise.plt"
        )
str(data_n_long)
```
```{r}

id_tp <- colsplit(as.character(data_n_long$id), "_", c("id", "tp"))
data_n_long <- cbind(id_tp, select(data_n_long, -id))
```

## AOI = Phone

```{r}
datList <- cbfnp_matlabFile$temporalScores[[8]][[1]][,,3]
summary(datList)
```
```{r}
datList.un <- lapply(datList, unlist, use.names=FALSE)
summary(datList.un)
str(datList.un)
```
```{r}
data_p <- as.data.frame(datList.un[[2]])
```
```{r}
names(data_p) <- datList.un[[3]]
```
```{r}
data_p$time <- datList.un[[4]][,1]
```
```{r}
data_p$aoi.name <- datList.un[[1]][,1]
```
```{r}
head(data_p[,c(1,ncol(data_p)-1,ncol(data_p))])
```

### Format data

```{r}
names(data)
data_p_long <- melt(data_p,
        # ID variables - all the variables to keep but not split apart on
        id.vars=c("time"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="id",
        value.name="phone.plt"
        )
str(data_p_long)
```
```{r}

id_tp <- colsplit(as.character(data_p_long$id), "_", c("id", "tp"))
data_p_long <- cbind(id_tp, select(data_p_long, -id))
```

## Merge datasets

```{r}
# dim(data_c_long)
# dim(data_b_long)
```

```{r}
# cbfnp <- rbind(data_c_long, data_b_long, data_f_long, data_n_long, data_p_long)
cbfnp <- data_c_long %>%
  left_join(data_b_long, by=c("id", "tp", "time")) %>%
  left_join(data_f_long, by=c("id", "tp", "time")) %>%
  left_join(data_n_long, by=c("id", "tp", "time")) %>%
  left_join(data_p_long, by=c("id", "tp", "time"))
cbfnp.8 <- cbfnp %>%
  mutate(stim="STATICIMAGES_ONSETPOPOUT8.TIF",
         trial=8) 
# head(cbfnp.8)
```

```{r}
rm(list=setdiff(ls(), ls(pattern = "cbfnp")))
```

# Attach datasets together

```{r}
cbfnp <- rbind(cbfnp.1,
               cbfnp.2, 
               cbfnp.3,
               cbfnp.4,
               cbfnp.5,
               cbfnp.6,
               cbfnp.7,
               cbfnp.8)
```

# Add non-aoi looks

```{r}
cbfnp.wide <- cbfnp %>%
  mutate(null.plt=ifelse(car.plt==0 & bird.plt==0 & face.plt==0 & noise.plt==0 & phone.plt==0, 1, 
                         ifelse(is.na(car.plt) & is.na(bird.plt) & is.na(face.plt) & is.na(noise.plt) & is.na(phone.plt), NA, 0)))
```
```{r}
cbfnp <- cbfnp.wide %>% 
  melt(# ID variables - all the variables to keep but not split apart on
        id.vars=c("id", "tp", "time", "stim", "trial"),
        # The source columns
        # measure.vars=c("control", "cond1", "cond2" ),
        # Name of the destination column that will identify the original
        # column that the measurement came from
        variable.name="aoi.name",
        value.name="plt"
        ) %>%
  mutate(aoi.name=gsub(pattern = ".plt", replacement = "", x = aoi.name),
         plt=as.numeric(plt))
```


# Attach demographic data

```{r}
demo_t1 <- read.csv("Data/Datasets/LEAP_t1_Core clinical variables_03-09-19-withlabels_&Inc,Ethn.csv")
demo_t2 <- read.csv("Data/Datasets/LEAP_t2_Core clinical variables_20-03-19-withlabels.csv")
```

```{r}
demo_t1_ft <- demo_t1 %>%
  dplyr::select(subjects, 
         t1_group,t1_diagnosis, 
         t1_site,
         t1_schedule_adj, t1_sex, t1_ageyrs, t1_fsiq,
         t1_srs_tscore, t1_vabsdscoresc_dss, t1_vabsdscoress_dss) %>%
  rename(id=subjects) %>%
  mutate(id=as.character(id)) %>%
  mutate_at(vars(7:11), funs( ifelse (. >=500, NA, .))) %>%
  mutate_at(vars(2:3), funs( ifelse (. =="TD" | . =="Control", "NT", paste(.)))) 

colnames(demo_t1_ft) <- sub("t1_", "", colnames(demo_t1_ft))

demo_t2_ft <- demo_t2 %>%
  dplyr::select(subjects,
         t2_ageyrs,
         t2_srs_tscore, t2_vabsdscoresc_dss, t2_vabsdscoress_dss) %>%
  rename(id=subjects) %>%
  mutate_at(vars(2:5), funs( ifelse (. >=500, NA, .))) %>%
  mutate(tp=2)

colnames(demo_t2_ft) <- sub("t2_", "", colnames(demo_t2_ft))
```

For now, I only add demo at tp 1 to the et data. 

```{r}
cbfnp.demo <- inner_join(cbfnp, demo_t1_ft, by="id")
head(cbfnp.demo)
```

```{r}
save(cbfnp.demo, file = "Data/SavedWS/pop-out-all-aois-demo-leap.RData")
save(demo_t1_ft, file = "Data/SavedWS/demo-leap.RData")
```











